# P_LOOKUP函数

## 说明

优化LOOKUP查找流程，轻松实现各类查找。

## 语法

P_LOOKUP(lookup_value, lookup_array, lookup_rule, return_array)

- lookup_value：要查找的内容。如果是多条件查找，就选择多个内容。
- lookup_array：查找的区域。如果是多条件查找，要确保区域第1行是标题。
- lookup_rule：查找的规则。
  - 如果查找单个内容，则填写数字，1表示查找第1个相同的结果，2表格第2个，以此类推。查找最后1个，写-1，最后第2个，写-2。
  - 如果查找多个内容，则选择参数1对应的标题。
- return_array：返回列任意单元格。

## 返回值

返回符合条件的查找结果。

## 案例1 查找最后1项

查找姓名列中，符合条件的最后1条记录。

![](http://mypic.ladeng6666.com/2017-09-23-P_LOOKUP.gif)

使用方法说明：

1. 第1个参数，是你要查找的信息，也就是刷卡人的名字。

2. 第2个参数，是要从哪里查找，也就是你的人员名单。

3. 第3个参数，这个是关键的地方，要查找第几个记录，就填几，第1个记录，就写1，第2个写2。

   如果是最后1笔记录呢，反过来了嘛，数字写负的就可以了。比如最后1笔，就写-1，倒数第2个，就写-2，以此类推。

4. 第4个参数，就是你要返回的列，随便选择，你要返回列的任意单元格就行，P_lookup函数，会返回这一列中，与查找结果在同一行的单元格。



## 案例2 多条件查找

根据尺码、颜色两个条件，查找符合条件的价格

![](http://mypic.ladeng6666.com/2017-09-23-%E5%A4%9A%E6%9D%A1%E4%BB%B6%E6%9F%A5%E6%89%BE.gif)

使用方法说明：

1. 参数1，是要查找的条件，我们要查找尺码和颜色，那就选择这两个区域。
2. 参数2，是要查找的范围，选择数据区域中，尺码和颜色的列。
   1. 数据区域的第1行，必须是标题行
   2. 标题的顺序没有要求，也就是说，B列是颜色，C列是尺码也没有关系。
3. 参数3，查找数据对应的标题行，因为我们要根据这个标题，去选择区域（参数2）里面找嘛，对吧。
4. 参数4，要返回的数据列中，对应的任意的单元格。我们d的重点，是要知道返回那一列，所以只要在这一列，选择哪个单元格，都无所谓啦。



## 案例3 反向查找

根据右侧的尺码，查找左侧的出库日期

![](http://mypic.ladeng6666.com/2017-09-23-%E5%8F%8D%E5%90%91%E6%9F%A5%E6%89%BE.gif)

使用方法说明：

1. 第1个参数，是你要查找的信息，也就是产品的名字。
2. 第2个参数，是查找的范围，也就是B列。
3. 第3个参数，之前介绍过了，查找最后1笔，就写-1，倒数第2个，就写-2，以此类推。
4. 第4个参数，这里是关键了哈。这个参数的意义，就是指定要返回哪一列，所有只要在返回列中，随便选一个单元格就行了。左边还是右边都行，我们不考虑这个问题。